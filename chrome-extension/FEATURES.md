# 43X Agent Tester - 辅助功能说明

本文档介绍 Chrome 插件的辅助功能，包括日志查看、设置管理和示例下载。

## 📄 查看日志

### 功能说明
- 查看所有历史测试记录
- 显示测试状态、轮次、耗时等详细信息
- 支持导出日志为 JSON 格式
- 支持打印日志
- 支持清空历史日志

### 使用方法
1. 点击 Popup UI 底部的 "📄 查看日志" 按钮
2. 在新窗口中查看所有测试记录
3. 可以使用以下操作：
   - **打印日志**: 打印当前日志列表
   - **导出 JSON**: 下载日志数据为 JSON 文件
   - **清空日志**: 删除所有历史记录（需确认）

### 日志内容
每条日志包含：
- 测试序号
- 场景名称
- 公司名称
- 测试状态（完成/停止/错误）
- 测试时间
- 对话轮次
- 总耗时
- 错误信息（如果有）

### 日志存储
- 日志保存在 `chrome.storage.local` 中
- 自动保留最近 50 条记录
- 每次测试完成、停止或出错时自动记录

---

## ⚙️ 设置

### 功能说明
配置测试系统的各项参数，包括服务地址、测试限制和高级选项。

### 使用方法
1. 点击 Popup UI 底部的 "⚙️ 设置" 按钮
2. 在设置页面修改配置
3. 点击 "保存设置" 按钮
4. 配置立即生效，无需重启插件

### 配置项说明

#### 🔌 Agent Service 配置

**Service URL**
- 默认值: `http://localhost:8001`
- 说明: Python Agent Service 的地址
- 格式: 完整的 HTTP/HTTPS URL
- 示例: `http://192.168.1.100:8001`

#### ⚙️ 测试参数

**最大对话轮次**
- 默认值: `50`
- 范围: 1-100
- 说明: 超过此轮次将自动终止测试
- 建议: 根据测试场景复杂度调整

**自动输入延迟 (毫秒)**
- 默认值: `1000`
- 范围: 0-10000
- 说明: 自动输入前的等待时间
- 建议: 网络较慢时可适当增加

**消息检测超时 (秒)**
- 默认值: `60`
- 范围: 10-300
- 说明: 等待新消息的最长时间
- 建议: LLM 响应较慢时可适当增加

#### 🔧 高级选项

**启用自动重试**
- 默认值: 开启
- 说明: 失败时自动重试操作（最多 3 次）
- 建议: 保持开启以提高稳定性

**调试模式**
- 默认值: 关闭
- 说明: 输出详细的调试日志到控制台
- 建议: 仅在调试时开启

**错误时自动截图**
- 默认值: 开启
- 说明: 发生错误时保存页面截图
- 建议: 保持开启以便问题排查

### 恢复默认设置
点击 "恢复默认" 按钮可以将所有配置恢复为默认值。

### 配置持久化
- 所有配置保存在 `chrome.storage.local` 中
- 配置在浏览器重启后保持
- 配置更新后立即同步到所有组件

---

## 📥 下载示例

### 功能说明
下载预配置的示例场景文件，帮助用户快速上手。

### 使用方法
1. 点击 Popup UI 底部的 "📥 下载示例" 按钮
2. 系统会自动下载 3 个示例配置文件
3. 可以直接使用或修改这些文件

### 示例场景

#### 1. ai_saas_pass.json
**AI SaaS 公司示例 - 预期通过初评**

```json
{
  "scenario_name": "ai_saas_pass",
  "company_name": "智语科技",
  "industry": "AI 客服 SaaS",
  "product": "基于大模型的智能客服系统",
  "revenue": "ARR 500万人民币",
  "team": "15人，核心团队来自阿里、腾讯",
  "funding_need": "A轮 2000万人民币",
  "expected_result": "passed",
  "project_details": {
    "customers": ["阿里巴巴", "腾讯", "字节跳动"],
    "technology": {
      "model": "GPT-4",
      "accuracy": "95%",
      "response_time": "2秒"
    },
    "financials": {
      "mrr": "42万",
      "growth_rate": "30% MoM",
      "churn_rate": "5%"
    }
  }
}
```

**特点**:
- 成熟的 AI SaaS 产品
- 有知名客户和稳定营收
- 技术指标优秀
- 适合测试正向评估流程

#### 2. hardware_reject.json
**硬件创业公司示例 - 预期拒绝**

```json
{
  "scenario_name": "hardware_reject",
  "company_name": "未来机器人",
  "industry": "硬件创业",
  "product": "消费级机器人",
  "revenue": "0",
  "team": "5人，无相关经验",
  "funding_need": "天使轮 500万人民币",
  "expected_result": "rejected",
  "project_details": {
    "stage": "原型阶段",
    "market": "消费市场",
    "competition": "强",
    "technology": "外购方案"
  }
}
```

**特点**:
- 早期硬件项目
- 团队经验不足
- 市场竞争激烈
- 适合测试拒绝场景

#### 3. medical_ai_edge.json
**医疗 AI 公司示例 - 边界案例**

```json
{
  "scenario_name": "medical_ai_edge",
  "company_name": "医疗 AI",
  "industry": "医疗 AI",
  "product": "AI 辅助诊断系统",
  "revenue": "ARR 200万",
  "team": "8人，医疗+AI 背景",
  "funding_need": "Pre-A 1000万人民币",
  "expected_result": "pending",
  "project_details": {
    "certifications": ["NMPA 二类医疗器械"],
    "hospitals": ["协和医院", "301医院"],
    "accuracy": "92%",
    "regulatory_risk": "中等"
  }
}
```

**特点**:
- 医疗 AI 领域
- 有资质和合作医院
- 存在监管风险
- 适合测试边界决策

### 自定义场景
用户可以基于示例文件创建自己的测试场景：

1. 下载示例文件
2. 使用文本编辑器打开
3. 修改字段内容
4. 保存为新的 JSON 文件
5. 在 Popup UI 中上传使用

### 必填字段
- `scenario_name`: 场景名称（唯一标识）
- `company_name`: 公司名称

### 可选字段
- `industry`: 行业分类
- `product`: 产品描述
- `revenue`: 营收情况
- `team`: 团队信息
- `funding_need`: 融资需求
- `expected_result`: 预期结果（passed/rejected/pending）
- `project_details`: 详细项目信息（JSON 对象）

---

## 🔄 配置同步

### 自动同步
- 在设置页面修改配置后，所有组件自动更新
- Background Service Worker 立即应用新配置
- Content Script 在下次操作时使用新配置
- Popup UI 实时反映配置变化

### 配置优先级
1. 用户在设置页面配置的值（最高优先级）
2. 场景配置文件中的覆盖值
3. 系统默认值（最低优先级）

---

## 📊 数据管理

### 存储位置
所有数据保存在 `chrome.storage.local` 中：

- `settings`: 用户配置
- `testLogs`: 测试日志（最多 50 条）
- `recentScenarios`: 最近使用的场景（最多 5 个）

### 数据清理
- 日志: 在日志查看窗口点击 "清空日志"
- 场景: 在场景下拉菜单中删除单个场景
- 配置: 在设置页面点击 "恢复默认"

### 数据导出
- 日志可以导出为 JSON 格式
- 场景配置可以下载为 JSON 文件
- 支持手动备份和恢复

---

## 🐛 故障排查

### 日志无法查看
- 检查是否有测试记录
- 检查浏览器弹窗设置
- 尝试在新标签页打开

### 设置无法保存
- 检查输入值是否在有效范围内
- 检查 URL 格式是否正确
- 查看控制台错误信息

### 示例下载失败
- 检查浏览器下载设置
- 检查是否允许多文件下载
- 尝试单独下载每个文件

### Service 连接失败
- 检查 Python Agent Service 是否运行
- 检查设置中的 Service URL 是否正确
- 检查网络连接和防火墙设置

---

## 💡 最佳实践

### 日志管理
- 定期导出重要测试日志
- 及时清理过期日志
- 使用日志分析测试趋势

### 配置管理
- 为不同环境创建不同配置
- 记录配置变更原因
- 定期备份配置

### 场景管理
- 为每个测试场景创建独立配置文件
- 使用描述性的场景名称
- 维护场景配置版本

---

## 🔗 相关文档

- [README.md](./README.md) - 插件总体说明
- [设计文档](../.kiro/specs/43x-agent-rpa-testing/design.md) - 系统架构设计
- [需求文档](../.kiro/specs/43x-agent-rpa-testing/requirements.md) - 功能需求说明
